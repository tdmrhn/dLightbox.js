/*
 * dLightbox.js
 * @author  dmrhn
 * @version 0.3
 * @url https://github.com/tdmrhn/dLightbox.js
 */
document.addEventListener("DOMContentLoaded",function(){var e,t,i,a,n,c=null,o=!1;function r(t,i,a){c=i,e=document.querySelectorAll('[data-lightbox-id="'+t+'"] .dLightbox_slider ul > li').length;var n=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+t+'"]'),o=n.querySelector(".dLightbox_slider ul"),r=n.querySelectorAll(".dL_thumbnails-container img");if(o){o.querySelectorAll("li.zoomed").forEach(function(e){e.classList.remove("zoomed"),e.querySelector("img").style.transform=""});var d=-(100*c);o.style.transform="translateX("+d+"%)",o.querySelectorAll("li").forEach(function(e){e.classList.remove("active")}),o.children[i].classList.add("active"),r[i]&&(r.forEach(function(e){e.classList.remove("active")}),r[i].classList.add("active"));var s=document.querySelector('[data-lightbox-id="'+t+'"]').classList.contains("dLightbox-captions"),l=document.querySelectorAll('[data-lightbox-id="'+t+'"] > figure');if(i<l.length){var v=l[i].querySelector("figcaption"),u=v?v.textContent:"",L=l[i].querySelector("img"),h=L?L.getAttribute("alt"):"";n.querySelector(".dL_count").innerHTML=i+1+"/"+e,s&&(n.querySelector(".dL_title").innerHTML=u||h)}}}function d(t,i){document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+t+'"]');var a,n=c;"prev"===i?a=n-1<0?e-1:n-1:"next"===i&&(a=(n+1)%e),r(t,a)}function s(e){var t=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+e+'"]');t&&(t.classList.remove("active"),document.body.classList.remove("dL_noscroll"))}document.querySelectorAll(".dLightbox").forEach(function(e,l){var v="dLightbox_"+l;e.setAttribute("data-lightbox-id",v),e.addEventListener("click",function(l){l.preventDefault();var u,L,h,f=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+v+'"]');f||(f=function e(t){var i,a=document.createElement("div");a.classList.add("dLightbox_canvas","active"),a.setAttribute("data-lightbox-id",t),a.innerHTML='<div class="dL_info-container"><div class="dL_count"></div><div class="dL_title"></div><div class="dL_close">&#x2715;</div></div><div class="dL_slides-container"><div class="dL_prev">&#8249;</div><div class="dLightbox_slider"><ul></ul></div><div class="dL_next">&#8250;</div></div>',document.body.appendChild(a);var n=a.querySelector(".dLightbox_slider ul"),c=[],o=document.querySelector('.dLightbox-thumbnails[data-lightbox-id="'+t+'"]');function d(){var e=Math.round(n.scrollLeft/n.clientWidth);c.forEach(function(e){e.classList.remove("active")}),c[e].classList.add("active")}return o&&(a.classList.add("dLightbox-thumbnails"),(i=document.createElement("div")).classList.add("dL_thumbnails-container"),a.appendChild(i),o.querySelectorAll("a").forEach(function(e,a){var o=e.getAttribute("href"),d=document.createElement("img");d.src=o,d.addEventListener("click",function(){c.forEach(function(e){e.classList.remove("active")}),d.classList.add("active"),n.style.transform="translateX(-"+100*a+"%)",r(t,a)}),c.push(d),i.appendChild(d)})),document.querySelectorAll('[data-lightbox-id="'+t+'"] > figure > a').forEach(function(e,i){var a=e.getAttribute("href"),o=document.createElement("li");o.innerHTML='<img src="'+a+'">';var d=document.createElement("img");d.src=a,d.addEventListener("click",function(){c.forEach(function(e){e.classList.remove("active")}),d.classList.add("active"),n.style.transform="translateX(-"+100*i+"%)",r(t,i)}),c.push(d),n.appendChild(o)}),a.querySelector(".dLightbox_slider").addEventListener("scroll",d),d(),a}(v),u=v,h=(L=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+u+'"]')).querySelector(".dLightbox_slider"),L.addEventListener("click",function(e){let t=e.target.classList;t.contains("dL_prev")?d(u,"prev"):t.contains("dL_next")?d(u,"next"):(t.contains("dL_close")||t.contains("dLightbox_canvas"))&&s(u)}),h.addEventListener("touchstart",function(e){t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY}),h.addEventListener("touchmove",function(e){Math.abs(e.changedTouches[0].clientX-t)>Math.abs(e.changedTouches[0].clientY-i)&&e.preventDefault()}),h.addEventListener("touchend",function(e){let i=e.changedTouches[0].clientX-t;Math.abs(i)>50&&d(u,i>0?"prev":"next")}),document.body.addEventListener("keydown",function(e){document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+u+'"]')&&(27===e.keyCode?s(u):(37===e.keyCode||39===e.keyCode)&&d(u,37===e.keyCode?"prev":"next"))}),h.addEventListener("wheel",function(e){e.preventDefault(),d(u,e.deltaY>0?"next":"prev")}),h.addEventListener("mousedown",function(e){a=e.clientX,n=0}),h.addEventListener("mousemove",function(e){n=e.clientX-a}),h.addEventListener("mouseup",function(e){Math.abs(n)>50?d(u,n>0?"prev":"next"):r(u,c)}),h.addEventListener("dblclick",function(e){var t=h.querySelector("li.active");t&&(t.classList.toggle("zoomed"),o=!o)}),h.addEventListener("mousemove",function(e){var t=h.querySelector("li.active.zoomed img");if(t){var i=(e.offsetX-t.offsetWidth/2)/t.offsetWidth,a=(e.offsetY-t.offsetHeight/2)/t.offsetHeight;t.style.transform="translate("+100*i+"%, "+100*a+"%)"}})),document.body.classList.add("dL_noscroll"),f.classList.add("active");var g=l.target.closest("a");if(g){var b=Array.from(e.querySelectorAll("a")).indexOf(g),x=b>c?"next":"prev";r(v,b,x)}})})});