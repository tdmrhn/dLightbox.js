/*
 * dLightbox.js
 * @author  dmrhn
 * @version 0.4
 * @url https://github.com/tdmrhn/dLightbox.js
 */
document.addEventListener("DOMContentLoaded",function(){var e,t,i,a,n,l=!1,c=null,o=0;function r(t,i,a){l=!1,c=i,e=document.querySelectorAll('[data-lightbox-id="'+t+'"] .dLightbox_slider ul > li').length;var n=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+t+'"]'),o=n.querySelector(".dLightbox_slider ul"),r=n.querySelectorAll(".dL_thumbnails-container img");if(o){o.querySelectorAll("li").forEach(function(e){e.classList.remove("zoomed"),e.querySelector("img").style.transform=""});var s=-(100*c);o.style.transform="translateX("+s+"%)",o.querySelectorAll("li").forEach(function(e){e.classList.remove("active")}),o.children[i].classList.add("active"),r[i]&&(r.forEach(function(e){e.classList.remove("active")}),r[i].classList.add("active"));var d=document.querySelector('[data-lightbox-id="'+t+'"]').classList.contains("dLightbox-captions"),v=document.querySelectorAll('[data-lightbox-id="'+t+'"] > figure');if(i<v.length){var u=v[i].querySelector("figcaption"),L=u?u.textContent:"",h=v[i].querySelector("img"),f=h?h.getAttribute("alt"):"";n.querySelector(".dL_count").innerHTML=i+1+"/"+e,d&&(n.querySelector(".dL_title").innerHTML=L||f)}}}function s(t,i){document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+t+'"]');var a,n=c;"prev"===i?a=n-1<0?e-1:n-1:"next"===i&&(a=(n+1)%e),r(t,a)}function d(e){var t=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+e+'"]');t&&(t.classList.remove("active"),document.body.classList.remove("dL_noscroll"))}document.querySelectorAll(".dLightbox").forEach(function(e,v){var u="dLightbox_"+v;e.setAttribute("data-lightbox-id",u),e.addEventListener("click",function(v){v.preventDefault();var L,h,f,g=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+u+'"]');g||(g=function e(t){var i,a=document.createElement("div");a.classList.add("dLightbox_canvas","active"),a.setAttribute("data-lightbox-id",t),a.innerHTML='<div class="dL_info-container"><div class="dL_count"></div><div class="dL_title"></div><div class="dL_close">&#x2715;</div></div><div class="dL_slides-container"><div class="dL_prev">&#8249;</div><div class="dLightbox_slider"><ul></ul></div><div class="dL_next">&#8250;</div></div>',document.body.appendChild(a);var n=a.querySelector(".dLightbox_slider ul"),l=[],c=document.querySelector('.dLightbox-thumbnails[data-lightbox-id="'+t+'"]');function o(){var e=Math.round(n.scrollLeft/n.clientWidth);l.forEach(function(e){e.classList.remove("active")}),l[e].classList.add("active")}return c&&(a.classList.add("dLightbox-thumbnails"),(i=document.createElement("div")).classList.add("dL_thumbnails-container"),a.appendChild(i),c.querySelectorAll("a").forEach(function(e,a){var c=e.getAttribute("href"),o=document.createElement("img");o.src=c,o.addEventListener("click",function(){l.forEach(function(e){e.classList.remove("active")}),o.classList.add("active"),n.style.transform="translateX(-"+100*a+"%)",r(t,a)}),l.push(o),i.appendChild(o)})),document.querySelectorAll('[data-lightbox-id="'+t+'"] > figure > a').forEach(function(e,i){var a=e.getAttribute("href"),c=document.createElement("li");c.innerHTML='<img src="'+a+'">';var o=document.createElement("img");o.src=a,o.addEventListener("click",function(){l.forEach(function(e){e.classList.remove("active")}),o.classList.add("active"),n.style.transform="translateX(-"+100*i+"%)",r(t,i)}),l.push(o),n.appendChild(c)}),a.querySelector(".dLightbox_slider").addEventListener("scroll",o),o(),a}(u),L=u,f=(h=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+L+'"]')).querySelector(".dLightbox_slider"),h.addEventListener("click",function(e){let t=e.target.classList;t.contains("dL_prev")?s(L,"prev"):t.contains("dL_next")?s(L,"next"):(t.contains("dL_close")||t.contains("dLightbox_canvas"))&&d(L)}),f.addEventListener("touchstart",function(e){var c=f.querySelector("li.active");if(c){let o=c.querySelector("img");if(c.classList.contains("zoomed")){if(2===e.touches.length)c.classList.contains("zoomed")?(c.classList.remove("zoomed"),o.style.transform=""):c.classList.add("zoomed");else if(1===e.touches.length&&!l){var r=e.touches[0];if(l=!0,o){let s=new DOMMatrixReadOnly(window.getComputedStyle(o).transform);a=r.clientX-s.m41,n=r.clientY-s.m42}}}else t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY}}),f.addEventListener("touchmove",function(e){if(l){e.preventDefault();var c=e.touches[0],o=f.querySelector("li.active.zoomed img");if(o){o.getBoundingClientRect();var r=c.clientX-a,s=c.clientY-n;o.style.transform="translate("+r+"px, "+s+"px)"}}else Math.abs(e.changedTouches[0].clientX-t)>Math.abs(e.changedTouches[0].clientY-i)&&e.preventDefault()}),f.addEventListener("touchend",function(e){if(l)l=!1;else{var i=e.changedTouches[0].clientX-t;Math.abs(i)>50&&s(L,i>0?"prev":"next")}}),document.body.addEventListener("keydown",function(e){document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+L+'"]')&&(27===e.keyCode?d(L):(37===e.keyCode||39===e.keyCode)&&s(L,37===e.keyCode?"prev":"next"))}),f.addEventListener("wheel",function(e){e.preventDefault(),s(L,e.deltaY>0?"next":"prev")}),f.addEventListener("dblclick",function(e){let t=f.querySelector("li.active");if(t){let i=t.querySelector("img");t.classList.contains("zoomed")?(t.classList.remove("zoomed"),i.style.transform=""):t.classList.add("zoomed")}}),f.addEventListener("mousedown",function(e){let t=f.querySelector("li.active.zoomed img");if(t){let i=window.getComputedStyle(t),c=new DOMMatrixReadOnly(i.transform);a=e.clientX-c.m41,n=e.clientY-c.m42,l=!0}else a=e.clientX,o=0}),f.addEventListener("mousemove",function(e){if(l){e.preventDefault();let t=f.querySelector("li.active.zoomed img");if(t){let i=e.clientX-a,c=e.clientY-n;t.style.transform="translate("+i+"px, "+c+"px)"}}else o=e.clientX-a}),f.addEventListener("mouseup",function(e){l?l=!1:Math.abs(o)>50?s(L,o>0?"prev":"next"):r(L,c)})),document.body.classList.add("dL_noscroll"),g.classList.add("active");var m=v.target.closest("a");if(m){var y=Array.from(e.querySelectorAll("a")).indexOf(m),b=y>c?"next":"prev";r(u,y,b)}})})});