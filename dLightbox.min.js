/*
 * dLightbox.min.js
 * @author  dmrhn
 * @version 0.6
 * @url https://github.com/tdmrhn/dLightbox.js
 */
document.addEventListener("DOMContentLoaded",()=>{let e,t,l,i,n,a=!1,r=0,c=0;function o(e,t){let l=document.createElement("div");l.className="dLightbox_canvas active",l.dataset.lightboxId=e,l.innerHTML=`<div class="dL_info-container"><div class="dL_count"></div><div class="dL_title"></div><div class="dL_close">&#x2715;</div></div><div class="dL_slides-container"><div class="dL_prev">&#8249;</div><div class="dLightbox_slider"><ul></ul></div><div class="dL_next">&#8250;</div></div>`,document.body.appendChild(l);let i=l.querySelector(".dLightbox_slider ul"),n=t.classList.contains("dLightbox-thumbnails"),a=null;if(n){let r=document.createElement("div");r.className="dL_thumbnail-carousel",(a=document.createElement("div")).className="dL_thumbnails-container",r.appendChild(a),l.appendChild(r),l.classList.add("dLightbox-thumbnails")}return t.querySelectorAll("figure > a").forEach((t,l)=>{let n=t.getAttribute("href"),r=document.createElement("li");if(r.innerHTML=`<img src="${n}">`,i.appendChild(r),a){let c=document.createElement("img");c.src=n,c.addEventListener("click",()=>{d(e,l),s(e,l)}),a.appendChild(c)}}),l}function s(e,t){let l=document.querySelector(`.dLightbox_canvas[data-lightbox-id="${e}"]`),i=l?.querySelector(".dL_thumbnails-container"),n=l?.querySelector(".dL_thumbnail-carousel");if(!i||!n)return;let a=i.querySelectorAll("img");a.forEach((e,l)=>e.classList.toggle("active",l===t));let r=n.offsetWidth,c=Math.floor(r/65);if(a.length<=c){i.style.transform="";return}let o=(a.length-c)*65;i.style.transform=`translateX(-${Math.max(0,Math.min((t-c/2+.5)*65,o))}px)`}function d(t,l){r=l;let i=document.querySelector(`.dLightbox_canvas[data-lightbox-id="${t}"]`),n=i.querySelector(".dLightbox_slider ul"),a=n.children;e=a.length,[...a].forEach(e=>{e.classList.remove("zoomed","active"),e.querySelector("img").style.transform=""}),s(t,l);let c="rtl"===document.documentElement.dir?100*l:-(100*l);n.style.transform=`translateX(${c}%)`,a[l].classList.add("active"),u(t,l)}function u(t,l){let i=document.querySelector(`.dLightbox_canvas[data-lightbox-id="${t}"]`),n=document.querySelector(`.dhn-lightbox[data-lightbox-id="${t}"]`),a=n.querySelectorAll("figure"),r=i.querySelector(".dL_count");if(r.textContent=`${l+1}/${e}`,n.classList.contains("dLightbox-captions")&&a[l]){let c=a[l].querySelector("figcaption")?.textContent||a[l].querySelector("img")?.alt||"";i.querySelector(".dL_title").textContent=c}}function v(t,l){let i="prev"===l?(r-1+e)%e:(r+1)%e;d(t,i)}function h(e){let t=document.querySelector(`.dLightbox_canvas.active[data-lightbox-id="${e}"]`);t&&(t.classList.remove("active"),document.body.classList.remove("dL_noscroll"))}function L(e){let o=document.querySelector(`.dLightbox_canvas.active[data-lightbox-id="${e}"]`),s=o.querySelector(".dLightbox_slider");o.addEventListener("click",t=>{let l=t.target.classList;return l.contains("dL_prev")?v(e,"prev"):l.contains("dL_next")?v(e,"next"):l.contains("dL_close")||l.contains("dLightbox_canvas")?h(e):void 0}),o.tabIndex=0,o.focus(),o.addEventListener("keydown",function(t){"Escape"===t.key?h(e):"ArrowLeft"===t.key?v(e,"prev"):"ArrowRight"===t.key&&v(e,"next")}),s.addEventListener("touchstart",function e(r){let c=s.querySelector("li.active");if(!c)return;let o=c.querySelector("img");if(c.classList.contains("zoomed")){if(2===r.touches.length)c.classList.remove("zoomed"),o.style.transform="";else if(1===r.touches.length){let d=r.touches[0],u=new DOMMatrixReadOnly(getComputedStyle(o).transform);a=!0,i=d.clientX-u.m41,n=d.clientY-u.m42}}else t=r.changedTouches[0].clientX,l=r.changedTouches[0].clientY}),s.addEventListener("touchmove",function e(r){if(a){r.preventDefault();let c=r.touches[0],o=s.querySelector("li.active.zoomed img");if(!o)return;let d=c.clientX-i,u=c.clientY-n;o.style.transform=`translate(${d}px, ${u}px)`}else{let v=Math.abs(r.changedTouches[0].clientX-t),h=Math.abs(r.changedTouches[0].clientY-l);v>h&&r.preventDefault()}}),s.addEventListener("touchend",function l(i){if(a){a=!1;return}let n=i.changedTouches[0].clientX-t;Math.abs(n)>50&&v(e,n>0?"prev":"next")}),s.addEventListener("mousedown",function e(t){let l=s.querySelector("li.active.zoomed img");if(l){let r=new DOMMatrixReadOnly(getComputedStyle(l).transform);a=!0,i=t.clientX-r.m41,n=t.clientY-r.m42}else i=t.clientX,c=0}),s.addEventListener("mousemove",function e(t){if(a){t.preventDefault();let l=s.querySelector("li.active.zoomed img");if(!l)return;let r=t.clientX-i,o=t.clientY-n;l.style.transform=`translate(${r}px, ${o}px)`}else c=t.clientX-i}),s.addEventListener("mouseup",function t(){a?a=!1:Math.abs(c)>50?v(e,c>0?"prev":"next"):d(e,r)}),s.addEventListener("wheel",t=>{t.preventDefault(),v(e,t.deltaY>0?"next":"prev")}),s.addEventListener("dblclick",()=>{let e=s.querySelector("li.active");if(!e)return;let t=e.querySelector("img");e.classList.contains("zoomed")?(e.classList.remove("zoomed"),t.style.transform=""):e.classList.add("zoomed")})}document.querySelectorAll(".dhn-lightbox").forEach((e,t)=>{let l="dLightbox_"+t;e.dataset.lightboxId=l,e.addEventListener("click",t=>{let i=t.target.closest("a");if(!i)return;t.preventDefault();let n=document.querySelector(`.dLightbox_canvas[data-lightbox-id="${l}"]`);n||(n=o(l,e),L(l)),document.body.classList.add("dL_noscroll"),n.classList.add("active");let a=[...e.querySelectorAll("a")].indexOf(i);d(l,a)})})});