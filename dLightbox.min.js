/*
 * dLightbox.js
 * @author  dmrhn
 * @version 0.5
 * @url https://github.com/tdmrhn/dLightbox.js
 */
document.addEventListener("DOMContentLoaded",function(){let e,t,i,l,n,o=!1,a=null,d=0;function c(e,t){let i=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+e+'"]'),l=i?.querySelector(".dL_thumbnails-container"),n=i?.querySelector(".dL_thumbnail-carousel");if(!l||!n)return;let o=l.querySelectorAll("img"),a=n.offsetWidth,d=Math.floor(a/65);if(o.forEach((e,i)=>{e.classList.toggle("active",i===t)}),o.length>d){let c=(o.length-d)*65;l.style.transform=`translateX(-${Math.max(0,Math.min((t-d/2+.5)*65,c))}px)`}else l.style.transform=""}function r(t,i){o=!1,a=i,e=document.querySelectorAll('[data-lightbox-id="'+t+'"] .dLightbox_slider ul > li').length;let l=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+t+'"]'),n=l.querySelector(".dLightbox_slider ul");if(!n)return;n.querySelectorAll("li").forEach(e=>{e.classList.remove("zoomed","active"),e.querySelector("img").style.transform=""}),c(t,i);let d="rtl"===document.documentElement.dir?100*a:-(100*a);n.style.transform=`translateX(${d}%)`,n.children[i].classList.add("active"),function t(i,l,n){let o=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+i+'"]'),a=document.querySelector('[data-lightbox-id="'+i+'"]').classList.contains("dLightbox-captions"),d=document.querySelectorAll('[data-lightbox-id="'+i+'"] > figure');if(l<d.length){let c=d[l].querySelector("figcaption"),r=c?.textContent||"",s=d[l].querySelector("img"),u=s?.getAttribute("alt")||"";o.querySelector(".dL_count").innerHTML=`${n}/${e}`,a&&(o.querySelector(".dL_title").innerHTML=r||u)}}(t,i,i+1)}function s(t,i){let l=a,n="prev"===i?l-1<0?e-1:l-1:(l+1)%e;r(t,n)}function u(e){let t=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+e+'"]');t&&(t.classList.remove("active"),document.body.classList.remove("dL_noscroll"))}document.querySelectorAll(".dLightbox").forEach(function(e,h){let v="dLightbox_"+h;e.setAttribute("data-lightbox-id",v),e.addEventListener("click",function(h){h.preventDefault();let L=document.querySelector('.dLightbox_canvas[data-lightbox-id="'+v+'"]');L||(L=function e(t){let i=document.createElement("div");i.classList.add("dLightbox_canvas","active"),i.setAttribute("data-lightbox-id",t),i.innerHTML=`<div class="dL_info-container"><div class="dL_count"></div><div class="dL_title"></div><div class="dL_close">&#x2715;</div></div><div class="dL_slides-container"><div class="dL_prev">&#8249;</div><div class="dLightbox_slider"><ul></ul></div><div class="dL_next">&#8250;</div></div>`,document.body.appendChild(i);let l=i.querySelector(".dLightbox_slider ul"),n,o=document.querySelector('.dLightbox-thumbnails[data-lightbox-id="'+t+'"]'),a=()=>{let e=document.createElement("div");e.classList.add("dL_thumbnail-carousel"),(n=document.createElement("div")).classList.add("dL_thumbnails-container"),e.appendChild(n),i.appendChild(e),o&&i.classList.add("dLightbox-thumbnails")},d=document.querySelectorAll(o?'.dLightbox-thumbnails[data-lightbox-id="'+t+'"] a':'[data-lightbox-id="'+t+'"] > figure > a');return d.forEach(function(e,i){let o=e.getAttribute("href"),d=document.createElement("li");d.innerHTML='<img src="'+o+'">',l.appendChild(d),0===i&&a();let s=document.createElement("img");s.src=o,s.addEventListener("click",()=>{r(t,i),c(t,i)}),n.appendChild(s)}),i}(v),function e(c){let h=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+c+'"]'),v=h.querySelector(".dLightbox_slider");h.addEventListener("click",function(e){let t=e.target.classList;t.contains("dL_prev")?s(c,"prev"):t.contains("dL_next")?s(c,"next"):(t.contains("dL_close")||t.contains("dLightbox_canvas"))&&u(c)}),v.addEventListener("touchstart",function e(a){let d=v.querySelector("li.active");if(!d)return;let c=d.querySelector("img");if(d.classList.contains("zoomed")){if(2===a.touches.length)d.classList.remove("zoomed"),c.style.transform="";else if(1===a.touches.length&&!o){let r=a.touches[0];o=!0;let s=new DOMMatrixReadOnly(window.getComputedStyle(c).transform);l=r.clientX-s.m41,n=r.clientY-s.m42}}else t=a.changedTouches[0].clientX,i=a.changedTouches[0].clientY}),v.addEventListener("touchmove",function e(a){if(o){a.preventDefault();let d=a.touches[0],c=v.querySelector("li.active.zoomed img");if(c){let r=d.clientX-l,s=d.clientY-n;c.style.transform=`translate(${r}px, ${s}px)`}}else{let u=Math.abs(a.changedTouches[0].clientX-t),h=Math.abs(a.changedTouches[0].clientY-i);u>h&&a.preventDefault()}}),v.addEventListener("touchend",function e(i){if(o)o=!1;else{let l=i.changedTouches[0].clientX-t;Math.abs(l)>50&&s(c,l>0?"prev":"next")}}),v.addEventListener("mousedown",function e(t){let i=v.querySelector("li.active.zoomed img");if(i){let a=new DOMMatrixReadOnly(window.getComputedStyle(i).transform);l=t.clientX-a.m41,n=t.clientY-a.m42,o=!0}else l=t.clientX,d=0}),v.addEventListener("mousemove",function e(t){if(o){t.preventDefault();let i=v.querySelector("li.active.zoomed img");if(i){let a=t.clientX-l,c=t.clientY-n;i.style.transform=`translate(${a}px, ${c}px)`}}else d=t.clientX-l}),v.addEventListener("mouseup",function e(t){o?o=!1:Math.abs(d)>50?s(c,d>0?"prev":"next"):r(c,a)}),document.body.addEventListener("keydown",function(e){let t=document.querySelector('.dLightbox_canvas.active[data-lightbox-id="'+c+'"]');t&&(27===e.keyCode?u(c):(37===e.keyCode||39===e.keyCode)&&s(c,37===e.keyCode?"prev":"next"))}),v.addEventListener("wheel",function(e){e.preventDefault(),s(c,e.deltaY>0?"next":"prev")}),v.addEventListener("dblclick",function(e){let t=v.querySelector("li.active");if(t){let i=t.querySelector("img");t.classList.contains("zoomed")?(t.classList.remove("zoomed"),i.style.transform=""):t.classList.add("zoomed")}})}(v)),document.body.classList.add("dL_noscroll"),L.classList.add("active");let g=h.target.closest("a");if(g){let f=Array.from(e.querySelectorAll("a")).indexOf(g);r(v,f)}})})});
